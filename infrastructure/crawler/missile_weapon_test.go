package crawler_test

import (
	"testing"

	"github.com/capybara-alt/my-assemble/infrastructure/crawler"
	"github.com/capybara-alt/my-assemble/model"
	"github.com/stretchr/testify/assert"
)

func TestMissileWeaponCrawler(t *testing.T) {
	test := struct {
		name string
		want model.Want[model.CrawlResultJSON]
	}{
		name: "[正常系]ミサイルページのクロールテスト",
		want: model.Want[model.CrawlResultJSON]{
			Value: model.CrawlResultJSON{
				string(model.DEFAULT_WEAPON_BACK_UNIT_TYPE): {
					"ミサイル": {
						"BML-G1/P20MLT-04": {
							"カテゴリー":   "MISSILE",
							"メーカー":    "ファーロン・ダイナミクス",
							"価格":      "74,000",
							"攻撃力":     "103×4",
							"衝撃力":     "72×4",
							"衝撃残留":    "43×4",
							"直撃補正":    "145",
							"誘導性能":    "180",
							"有効射程":    "2500",
							"誘導ロック時間": "0.3",
							"最大ロック数":  "4",
							"総弾数":     "140",
							"リロード時間":  "4.0",
							"弾単価":     "80",
							"重量":      "2120",
							"EN負荷":    "154",
						},
						"BML-G2/P03MLT-06": {
							"カテゴリー":   "MISSILE",
							"メーカー":    "ファーロン・ダイナミクス",
							"価格":      "111,000",
							"攻撃力":     "103×6",
							"衝撃力":     "72×6",
							"衝撃残留":    "43×6",
							"直撃補正":    "145",
							"誘導性能":    "180",
							"有効射程":    "2500",
							"誘導ロック時間": "0.4",
							"最大ロック数":  "6",
							"総弾数":     "228",
							"リロード時間":  "5.0",
							"弾単価":     "80",
							"重量":      "3840",
							"EN負荷":    "241",
						},
						"BML-G2/P05MLT-10": {
							"カテゴリー":   "MISSILE",
							"メーカー":    "ファーロン・ダイナミクス",
							"価格":      "165,000",
							"攻撃力":     "103×10",
							"衝撃力":     "72×10",
							"衝撃残留":    "43×10",
							"直撃補正":    "145",
							"誘導性能":    "180",
							"有効射程":    "2500",
							"誘導ロック時間": "0.8",
							"最大ロック数":  "10",
							"総弾数":     "300",
							"リロード時間":  "6.4",
							"弾単価":     "80",
							"重量":      "5220",
							"EN負荷":    "320",
						},
					},
					"分裂ミサイル": {
						"BML-G2/P19SPL-12": {
							"カテゴリー":   "SPLIT MISSILE",
							"メーカー":    "ファーロン・ダイナミクス",
							"価格":      "123,000",
							"攻撃力":     "600×2",
							"衝撃力":     "402×2",
							"衝撃残留":    "240×2",
							"直撃補正":    "140",
							"誘導性能":    "135",
							"有効射程":    "1425",
							"誘導ロック時間": "1.5",
							"最大ロック数":  "2",
							"総弾数":     "80",
							"リロード時間":  "6.0",
							"弾単価":     "400",
							"重量":      "3580",
							"EN負荷":    "325",
						},
						"BML-G2/P16SPL-08": {
							"カテゴリー":   "SPLIT MISSILE",
							"メーカー":    "ファーロン・ダイナミクス",
							"価格":      "85,000",
							"攻撃力":     "688",
							"衝撃力":     "536",
							"衝撃残留":    "320",
							"直撃補正":    "140",
							"誘導性能":    "135",
							"有効射程":    "1425",
							"誘導ロック時間": "1.5",
							"最大ロック数":  "1",
							"総弾数":     "40",
							"リロード時間":  "5.1",
							"弾単価":     "500",
							"重量":      "2800",
							"EN負荷":    "228",
						},
						"BML-G2/P17SPL-16": {
							"カテゴリー":   "SPLIT MISSILE",
							"メーカー":    "ファーロン・ダイナミクス",
							"価格":      "160,000",
							"攻撃力":     "688×2",
							"衝撃力":     "536×2",
							"衝撃残留":    "320×2",
							"直撃補正":    "140",
							"誘導性能":    "135",
							"有効射程":    "1425",
							"誘導ロック時間": "2.0",
							"最大ロック数":  "2",
							"総弾数":     "72",
							"リロード時間":  "7.7",
							"弾単価":     "500",
							"重量":      "5010",
							"EN負荷":    "510",
						},
					},
					"双対ミサイル": {
						"BML-G1/P31DUO-02": {
							"カテゴリー":    "DUAL MISSILE",
							"メーカー":     "ファーロン・ダイナミクス",
							"価格":       "144,000",
							"レギュレーション": "1.03.1",
							"攻撃力":      "148×4 (+26)",
							"衝撃力":      "94×4 (+18)",
							"衝撃残留":     "62×4 (+12)",
							"直撃補正":     "150",
							"誘導性能":     "145 (+20)",
							"有効射程":     "500",
							"誘導ロック時間":  "0.4",
							"最大ロック数":   "2",
							"総弾数":      "124",
							"リロード時間":   "3.5",
							"弾単価":      "70",
							"重量":       "1900",
							"EN負荷":     "182",
						},
						"BML-G1/P32DUO-03": {
							"カテゴリー":    "DUAL MISSILE",
							"メーカー":     "ファーロン・ダイナミクス",
							"価格":       "180,000",
							"レギュレーション": "1.03.1",
							"攻撃力":      "148×6 (+26)",
							"衝撃力":      "94×6 (+18)",
							"衝撃残留":     "62×6 (+12)",
							"直撃補正":     "150",
							"誘導性能":     "145 (+20)",
							"有効射程":     "500",
							"誘導ロック時間":  "0.4",
							"最大ロック数":   "3",
							"総弾数":      "180",
							"リロード時間":   "4.3",
							"弾単価":      "70",
							"重量":       "3450",
							"EN負荷":     "262",
						},
						"BML-G2/P08DUO-03": {
							"カテゴリー":    "DUAL MISSILE",
							"メーカー":     "ファーロン・ダイナミクス",
							"価格":       "228,000",
							"レギュレーション": "1.03",
							"攻撃力":      "177×6 (+31)",
							"衝撃力":      "111×6 (+22)",
							"衝撃残留":     "72×6 (+14)",
							"直撃補正":     "150",
							"誘導性能":     "145 (+20)",
							"有効射程":     "500",
							"誘導ロック時間":  "0.7",
							"最大ロック数":   "6",
							"総弾数":      "156",
							"リロード時間":   "5.8",
							"弾単価":      "100",
							"重量":       "4020",
							"EN負荷":     "332",
						},
					},
					"垂直ミサイル": {
						"BML-G1/P01VTC-04": {
							"カテゴリー":   "VERTICAL MISSILE",
							"メーカー":    "ファーロン・ダイナミクス",
							"価格":      "85,000",
							"攻撃力":     "124×4",
							"衝撃力":     "89×4",
							"衝撃残留":    "55×4",
							"直撃補正":    "150",
							"誘導性能":    "480",
							"有効射程":    "1000",
							"誘導ロック時間": "0.4",
							"最大ロック数":  "4",
							"総弾数":     "108",
							"リロード時間":  "4.8",
							"弾単価":     "120",
							"重量":      "2240",
							"EN負荷":    "258",
						},
						"BML-G1/P03VTC-08": {
							"カテゴリー":   "VERTICAL MISSILE",
							"メーカー":    "ファーロン・ダイナミクス",
							"価格":      "112,000",
							"攻撃力":     "124×8",
							"衝撃力":     "89×8",
							"衝撃残留":    "55×8",
							"直撃補正":    "150",
							"誘導性能":    "480",
							"有効射程":    "1000",
							"誘導ロック時間": "0.8",
							"最大ロック数":  "8",
							"総弾数":     "224",
							"リロード時間":  "6.0",
							"弾単価":     "120",
							"重量":      "3920",
							"EN負荷":    "380",
						},
						"BML-G1/P07VTC-12": {
							"カテゴリー":   "VERTICAL MISSILE",
							"メーカー":    "ファーロン・ダイナミクス",
							"価格":      "188,000",
							"攻撃力":     "124×12",
							"衝撃力":     "89×12",
							"衝撃残留":    "55×12",
							"直撃補正":    "150",
							"誘導性能":    "480",
							"有効射程":    "1000",
							"誘導ロック時間": "1.4",
							"最大ロック数":  "12",
							"総弾数":     "360",
							"リロード時間":  "7.5",
							"弾単価":     "120",
							"重量":      "5010",
							"EN負荷":    "525",
						},
					},
					"高誘導ミサイル": {
						"BML-G3/P04ACT-01": {
							"カテゴリー":    "ACTIVE HOMING MISSILE",
							"メーカー":     "ファーロン・ダイナミクス",
							"価格":       "98,000",
							"レギュレーション": "1.03",
							"攻撃力":      "486",
							"衝撃力":      "540",
							"衝撃残留":     "378",
							"爆発範囲":     "12",
							"直撃補正":     "165",
							"誘導性能":     "115 (+25)",
							"有効射程":     "1000",
							"誘導ロック時間":  "2.0 (-1)",
							"最大ロック数":   "1",
							"総弾数":      "45",
							"リロード時間":   "2.4",
							"弾単価":      "450",
							"重量":       "2680",
							"EN負荷":     "213",
						},
						"BML-G3/P05ACT-02": {
							"カテゴリー":    "ACTIVE HOMING MISSILE",
							"メーカー":     "ファーロン・ダイナミクス",
							"価格":       "145,000",
							"レギュレーション": "1.03",
							"攻撃力":      "486×2",
							"衝撃力":      "540×2",
							"衝撃残留":     "378×2",
							"爆発範囲":     "12",
							"直撃補正":     "165",
							"誘導性能":     "115 (+25)",
							"有効射程":     "1000",
							"誘導ロック時間":  "2.8 (-1.2)",
							"最大ロック数":   "2",
							"総弾数":      "72",
							"リロード時間":   "4.2",
							"弾単価":      "450",
							"重量":       "4320",
							"EN負荷":     "424",
						},
					},
					"コンテナミサイル": {
						"BML-G1/P29CNT": {
							"カテゴリー":  "CONTAINER MISSILE",
							"メーカー":   "ファーロン・ダイナミクス",
							"価格":     "250,000",
							"攻撃力":    "1422",
							"衝撃力":    "1278",
							"衝撃残留":   "828",
							"直撃補正":   "140",
							"誘導性能":   "120",
							"有効射程":   "700",
							"総弾数":    "12",
							"リロード時間": "12.0",
							"弾単価":    "800",
							"重量":     "6370",
							"EN負荷":   "150",
						},
					},
					"クラスターミサイル": {
						"WR-0999 DELIVERY BOY": {
							"カテゴリー":   "CLUSTER MISSILE",
							"メーカー":    "RaD",
							"価格":      "298,000",
							"攻撃力":     "2133",
							"衝撃力":     "2040",
							"衝撃残留":    "1638",
							"爆発範囲":    "24",
							"直撃補正":    "175",
							"誘導性能":    "200",
							"有効射程":    "1049",
							"誘導ロック時間": "5.0",
							"最大ロック数":  "1",
							"総弾数":     "20",
							"リロード時間":  "9.0",
							"弾単価":     "600",
							"重量":      "6890",
							"EN負荷":    "499",
						},
					},
					"散布型ミサイル": {
						"WS-5001 SOUP": {
							"カテゴリー":   "SCATTER MISSILE",
							"メーカー":    "RaD",
							"価格":      "326,000",
							"攻撃力":     "78×10",
							"衝撃力":     "77×10",
							"衝撃残留":    "55×10",
							"直撃補正":    "145",
							"誘導性能":    "180",
							"有効射程":    "2500",
							"誘導ロック時間": "0.5",
							"最大ロック数":  "1",
							"総弾数":     "420",
							"リロード時間":  "8.0",
							"弾単価":     "50",
							"重量":      "5620",
							"EN負荷":    "680",
						},
					},
					"デトネイティングミサイル": {
						"45-091 JVLN BETA": {
							"カテゴリー":   "DETONATING MISSILE",
							"メーカー":    "オールマインド",
							"価格":      "210,000",
							"攻撃力":     "791",
							"衝撃力":     "717",
							"衝撃残留":    "563",
							"爆発範囲":    "20",
							"直撃補正":    "165",
							"誘導性能":    "360",
							"有効射程":    "360",
							"誘導ロック時間": "2.4",
							"最大ロック数":  "1",
							"総弾数":     "32",
							"リロード時間":  "3.6",
							"弾単価":     "450",
							"重量":      "4250",
							"EN負荷":    "425",
						},
					},
					"ニードルミサイル": {
						"EL-PW-01 TRUENO": {
							"カテゴリー":    "NEEDLE MISSILE",
							"メーカー":     "エルカノ",
							"価格":       "271,000",
							"レギュレーション": "1.03",
							"攻撃力":      "415×2",
							"衝撃力":      "385×2",
							"衝撃残留":     "215×2",
							"直撃補正":     "215",
							"誘導性能":     "110 (-10)",
							"性能保証射程":   "310",
							"有効射程":     "410",
							"誘導ロック時間":  "4.2",
							"最大ロック数":   "1",
							"総弾数":      "62",
							"リロード時間":   "4.2",
							"弾単価":      "300",
							"重量":       "3100",
							"EN負荷":     "420",
						},
					},
					"プラズマミサイル": {
						"Vvc-703PM": {
							"カテゴリー":   "PLASMA MISSILE",
							"メーカー":    "VCPL",
							"価格":      "202,000",
							"攻撃力":     "760",
							"衝撃力":     "384",
							"衝撃残留":    "248",
							"爆発範囲":    "26",
							"直撃補正":    "125",
							"誘導性能":    "180",
							"有効射程":    "1500",
							"誘導ロック時間": "0.3",
							"最大ロック数":  "3",
							"総弾数":     "120",
							"リロード時間":  "4.0",
							"弾単価":     "100",
							"重量":      "2720",
							"EN負荷":    "245",
						},
						"Vvc-706PM": {
							"カテゴリー":   "PLASMA MISSILE",
							"メーカー":    "VCPL",
							"価格":      "310,000",
							"攻撃力":     "760",
							"衝撃力":     "384",
							"衝撃残留":    "248",
							"爆発範囲":    "26",
							"直撃補正":    "125",
							"誘導性能":    "180",
							"有効射程":    "1500",
							"誘導ロック時間": "0.3",
							"最大ロック数":  "6",
							"総弾数":     "210",
							"リロード時間":  "6.0",
							"弾単価":     "100",
							"重量":      "4800",
							"EN負荷":    "342",
						},
						"Vvc-70VPM": {
							"カテゴリー":   "PLASMA MISSILE",
							"メーカー":    "VCPL",
							"価格":      "96,000",
							"攻撃力":     "760",
							"衝撃力":     "384",
							"衝撃残留":    "248",
							"爆発範囲":    "26",
							"直撃補正":    "125",
							"誘導性能":    "180",
							"有効射程":    "750",
							"誘導ロック時間": "0.5",
							"最大ロック数":  "5",
							"総弾数":     "240",
							"リロード時間":  "6.2",
							"弾単価":     "150",
							"重量":      "3760",
							"EN負荷":    "268",
						},
					},
					"コーラルミサイル": {
						"IB-C03W3: NGI 006": {
							"カテゴリー":    "CORAL MISSILE",
							"メーカー":     "ルビコン調査技研",
							"価格":       "380,000",
							"レギュレーション": "1.03",
							"攻撃力":      "827",
							"衝撃力":      "720",
							"衝撃残留":     "720",
							"爆発範囲":     "36",
							"チャージ攻撃力":  "4078 (-921)",
							"チャージ衝撃力":  "2496 (-672)",
							"チャージ衝撃残留": "2496 (-672)",
							"チャージ爆発範囲": "56",
							"直撃補正":     "165 (-20)",
							"誘導性能":     "110",
							"有効射程":     "1000",
							"誘導ロック時間":  "4.9",
							"最大ロック数":   "1",
							"チャージEN負荷": "932",
							"チャージ時間":   "3.5",
							"チャージ消費弾数": "1",
							"総弾数":      "24",
							"リロード時間":   "8.6",
							"弾単価":      "650",
							"重量":       "4200",
							"EN負荷":     "783",
						},
					},
				},
			},
			ErrMsg: "",
		},
	}
	c := crawler.NewMissileWeapon()
	t.Run(test.name, func(t *testing.T) {
		results, err := c.Fetch()
		assert.Equal(t, err, nil)
		assert.Equal(t, test.want.Value, results)
	})
}
