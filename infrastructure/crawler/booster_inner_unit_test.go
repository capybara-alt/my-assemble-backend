package crawler_test

import (
	"testing"

	"github.com/capybara-alt/my-assemble/infrastructure/crawler"
	"github.com/capybara-alt/my-assemble/model"
	"github.com/stretchr/testify/assert"
)

func TestBoosterCrawler(t *testing.T) {
	test := struct {
		name string
		want model.Want[model.CrawlResultJSON]
	}{
		name: "[正常系]Boosterページのクロールテスト",
		want: model.Want[model.CrawlResultJSON]{
			Value: model.CrawlResultJSON{
				string(model.BOOSTER_INNER_UNIT_TYPE): {
					"ブースタ": {
						"AB-J-137 KIKAKU": {
							"メーカー":       "BAWS",
							"価格":         "53,000",
							"レギュレーション":   "1.03.1",
							"推力":         "5667",
							"上昇推力":       "4917 (+333)",
							"上昇消費EN":     "656",
							"QB推力":       "19150",
							"QB噴射時間":     "0.31",
							"QB消費EN":     "550",
							"QBリロード時間":   "0.55",
							"QBリロード保証重量": "75800",
							"AB推力":       "8218",
							"AB消費EN":     "320",
							"近接攻撃推力":     "14019",
							"近接攻撃消費EN":   "425",
							"重量":         "1820",
							"EN負荷":       "266",
						},
						"BST-G2/P04": {
							"メーカー":       "ファーロン・ダイナミクス",
							"価格":         "72,000",
							"レギュレーション":   "1.03.1",
							"推力":         "6001",
							"上昇推力":       "5400 (+500)",
							"上昇消費EN":     "650",
							"QB推力":       "20600",
							"QB噴射時間":     "0.38",
							"QB消費EN":     "560",
							"QBリロード時間":   "0.56",
							"QBリロード保証重量": "82000",
							"AB推力":       "8501",
							"AB消費EN":     "353",
							"近接攻撃推力":     "9668",
							"近接攻撃消費EN":   "470",
							"重量":         "1710",
							"EN負荷":       "250",
						},
						"BST-G1/P10": {
							"メーカー":       "ファーロン・ダイナミクス",
							"価格":         "-",
							"レギュレーション":   "1.03.1",
							"推力":         "5734",
							"上昇推力":       "5084 (+417)",
							"上昇消費EN":     "630",
							"QB推力":       "17600",
							"QB噴射時間":     "0.39",
							"QB消費EN":     "480",
							"QBリロード時間":   "0.60",
							"QBリロード保証重量": "65200",
							"AB推力":       "8735",
							"AB消費EN":     "377",
							"近接攻撃推力":     "8218",
							"近接攻撃消費EN":   "529",
							"重量":         "1300",
							"EN負荷":       "130",
						},
						"BST-G2/P06SPD": {
							"メーカー":       "ファーロン・ダイナミクス",
							"価格":         "133,000",
							"レギュレーション":   "1.03.1",
							"推力":         "6801",
							"上昇推力":       "5217 (+417)",
							"上昇消費EN":     "672",
							"QB推力":       "18600",
							"QB噴射時間":     "0.36",
							"QB消費EN":     "700",
							"QBリロード時間":   "0.50",
							"QBリロード保証重量": "76000",
							"AB推力":       "8685",
							"AB消費EN":     "381",
							"近接攻撃推力":     "10652",
							"近接攻撃消費EN":   "507",
							"重量":         "1420",
							"EN負荷":       "390",
						},
						"ALULA/21E": {
							"メーカー":       "シュナイダー",
							"価格":         "60,000",
							"レギュレーション":   "1.03.1",
							"推力":         "6668",
							"上昇推力":       "5067 (+417)",
							"上昇消費EN":     "760",
							"QB推力":       "21650",
							"QB噴射時間":     "0.30",
							"QB消費EN":     "690",
							"QBリロード時間":   "0.35",
							"QBリロード保証重量": "62400",
							"AB推力":       "9085",
							"AB消費EN":     "435",
							"近接攻撃推力":     "10868",
							"近接攻撃消費EN":   "575",
							"重量":         "1900",
							"EN負荷":       "410",
						},
						"FLUEGEL/21Z": {
							"メーカー":       "シュナイダー",
							"価格":         "202,000",
							"レギュレーション":   "1.03.1",
							"推力":         "6101",
							"上昇推力":       "5634 (+500)",
							"上昇消費EN":     "680",
							"QB推力":       "20000",
							"QB噴射時間":     "0.40",
							"QB消費EN":     "600",
							"QBリロード時間":   "0.50",
							"QBリロード保証重量": "73800",
							"AB推力":       "8668",
							"AB消費EN":     "398",
							"近接攻撃推力":     "9918",
							"近接攻撃消費EN":   "543",
							"重量":         "1980",
							"EN負荷":       "282",
						},
						"BUERZEL/21D": {
							"メーカー":       "シュナイダー",
							"価格":         "151,000",
							"推力":         "6167",
							"上昇推力":       "4834",
							"上昇消費EN":     "710",
							"QB推力":       "18050",
							"QB噴射時間":     "0.26",
							"QB消費EN":     "536",
							"QBリロード時間":   "0.91",
							"QBリロード保証重量": "100600",
							"AB推力":       "10085",
							"AB消費EN":     "378",
							"近接攻撃推力":     "10402",
							"近接攻撃消費EN":   "588",
							"重量":         "2240",
							"EN負荷":       "480",
						},
						"BC-0600 12345": {
							"メーカー":       "RaD",
							"価格":         "84,000",
							"レギュレーション":   "1.03.1",
							"推力":         "5801",
							"上昇推力":       "5200 (+500)",
							"上昇消費EN":     "800",
							"QB推力":       "18900",
							"QB噴射時間":     "0.54",
							"QB消費EN":     "520",
							"QBリロード時間":   "0.80",
							"QBリロード保証重量": "97000",
							"AB推力":       "8084",
							"AB消費EN":     "372",
							"近接攻撃推力":     "8118",
							"近接攻撃消費EN":   "496",
							"重量":         "1360",
							"EN負荷":       "180",
						},
						"BC-0400 MULE": {
							"メーカー":       "RaD",
							"価格":         "88,000",
							"レギュレーション":   "1.03.1",
							"推力":         "5417",
							"上昇推力":       "4767 (+333)",
							"上昇消費EN":     "405",
							"QB推力":       "17500",
							"QB噴射時間":     "0.46",
							"QB消費EN":     "670",
							"QBリロード時間":   "0.58",
							"QBリロード保証重量": "80000",
							"AB推力":       "7584",
							"AB消費EN":     "381",
							"近接攻撃推力":     "7018",
							"近接攻撃消費EN":   "390",
							"重量":         "970",
							"EN負荷":       "200",
						},
						"BC-0200 GRIDWALKER": {
							"メーカー":       "RaD",
							"価格":         "169,000",
							"推力":         "6401",
							"上昇推力":       "6334",
							"上昇消費EN":     "660",
							"QB推力":       "19000",
							"QB噴射時間":     "0.33",
							"QB消費EN":     "660",
							"QBリロード時間":   "0.70",
							"QBリロード保証重量": "60900",
							"AB推力":       "8585",
							"AB消費EN":     "387",
							"近接攻撃推力":     "11468",
							"近接攻撃消費EN":   "520",
							"重量":         "2010",
							"EN負荷":       "244",
						},
						"IA-C01B: GILLS": {
							"メーカー":       "ルビコン調査技研",
							"価格":         "296,000",
							"レギュレーション":   "1.03.1",
							"推力":         "6317",
							"上昇推力":       "5334 (+333)",
							"上昇消費EN":     "580",
							"QB推力":       "18850",
							"QB噴射時間":     "0.28",
							"QB消費EN":     "620",
							"QBリロード時間":   "0.30",
							"QBリロード保証重量": "68300",
							"AB推力":       "8335",
							"AB消費EN":     "391",
							"近接攻撃推力":     "6184",
							"近接攻撃消費EN":   "630",
							"重量":         "1590",
							"EN負荷":       "400",
						},
						"IB-C03B: NGI 001": {
							"メーカー":       "ルビコン調査技研",
							"価格":         "323,000",
							"レギュレーション":   "1.03.1",
							"推力":         "6467",
							"上昇推力":       "6001 (+500)",
							"上昇消費EN":     "750",
							"QB推力":       "22200",
							"QB噴射時間":     "0.43",
							"QB消費EN":     "740",
							"QBリロード時間":   "0.63",
							"QBリロード保証重量": "90200",
							"AB推力":       "8835",
							"AB消費EN":     "405",
							"近接攻撃推力":     "10535",
							"近接攻撃消費EN":   "558",
							"重量":         "1930",
							"EN負荷":       "342",
						},
					},
				},
			},
			ErrMsg: "",
		},
	}
	c := crawler.NewBoosterInnerUnit()
	t.Run(test.name, func(t *testing.T) {
		results, err := c.Fetch()
		assert.Equal(t, err, nil)
		assert.Equal(t, test.want.Value, results)
	})
}
