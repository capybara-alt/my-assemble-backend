package crawler_test

import (
	"testing"

	"github.com/capybara-alt/my-assemble/crawler"
	"github.com/capybara-alt/my-assemble/model"
	"github.com/stretchr/testify/assert"
)

func TestCrossWeaponCrawler(t *testing.T) {
	test := struct {
		name string
		want model.Want[model.CrawlResultJSON]
	}{
		name: "[正常系]近接武器ページのクロールテスト",
		want: model.Want[model.CrawlResultJSON]{
			Value: model.CrawlResultJSON{
				string(model.CROSS_WEAPON_UNIT_TYPE): {
					"パイルバンカー": {
						"PB-033M ASHMEAD": {
							"カテゴリー":    "PILE BUNKER",
							"メーカー":     "ベイラム",
							"価格":       "185,000",
							"攻撃力":      "1688",
							"衝撃力":      "1150",
							"衝撃残留":     "850",
							"連続攻撃回数":   "1",
							"チャージ攻撃力":  "4630",
							"チャージ衝撃力":  "1800",
							"チャージ衝撃残留": "1100",
							"直撃補正":     "150",
							"PA干渉":     "135",
							"冷却性能":     "284",
							"重量":       "4180",
							"EN負荷":     "225",
						},
					},
					"炸裂弾投射機": {
						"DF-ET-09 TAI-YANG-SHOU": {
							"カテゴリー":    "EXPLOSIVE THROWER",
							"メーカー":     "大豊",
							"価格":       "215,000",
							"レギュレーション": "1.03.1",
							"攻撃力":      "1142",
							"衝撃力":      "830",
							"衝撃残留":     "650",
							"爆発範囲":     "20",
							"チャージ攻撃力":  "1142",
							"チャージ衝撃力":  "830",
							"チャージ衝撃残留": "650",
							"チャージ爆発範囲": "25",
							"直撃補正":     "190",
							"有効射程":     "125 (+45)",
							"総弾数":      "48 (+23)",
							"リロード時間":   "3.1 (-0.9)",
							"弾単価":      "600",
							"重量":       "3790",
							"EN負荷":     "160",
						},
					},
					"チェーンソー": {
						"WB-0010 DOUBLE TROUBLE": {
							"カテゴリー":    "CHAINSAW",
							"メーカー":     "RaD",
							"価格":       "69,000",
							"攻撃力":      "1025",
							"衝撃力":      "750",
							"衝撃残留":     "375",
							"連続攻撃回数":   "2",
							"チャージ攻撃力":  "2970",
							"チャージ衝撃力":  "2380",
							"チャージ衝撃残留": "840",
							"直撃補正":     "270",
							"PA干渉":     "119",
							"冷却性能":     "302",
							"重量":       "5090",
							"EN負荷":     "108",
						},
					},
					"スタンバトン": {
						"VP-67EB": {
							"カテゴリー":    "STUN BATON",
							"メーカー":     "アーキバス",
							"価格":       "94,000",
							"攻撃力":      "229",
							"衝撃力":      "215",
							"衝撃残留":     "85",
							"連続攻撃回数":   "3",
							"チャージ攻撃力":  "1461",
							"チャージ衝撃力":  "1360",
							"チャージ衝撃残留": "590",
							"直撃補正":     "215",
							"PA干渉":     "140",
							"冷却性能":     "1156",
							"重量":       "1720",
							"EN負荷":     "198",
						},
					},
					"レーザーダガー": {
						"VP-67LD": {
							"カテゴリー":    "LASER DAGGER",
							"メーカー":     "アーキバス",
							"価格":       "135,000",
							"攻撃力":      "752",
							"衝撃力":      "310",
							"衝撃残留":     "120",
							"連続攻撃回数":   "3",
							"チャージ攻撃力":  "1688",
							"チャージ衝撃力":  "1100",
							"チャージ衝撃残留": "375",
							"直撃補正":     "175",
							"PA干渉":     "118",
							"冷却性能":     "1308",
							"重量":       "1350",
							"EN負荷":     "150",
						},
					},
					"レーザーブレード": {
						"Vvc-770LB": {
							"カテゴリー":    "LASER BLADE",
							"メーカー":     "VCPL",
							"価格":       "210,000",
							"攻撃力":      "1630",
							"衝撃力":      "1100",
							"衝撃残留":     "330",
							"連続攻撃回数":   "1",
							"チャージ攻撃力":  "1170×2",
							"チャージ衝撃力":  "750×2",
							"チャージ衝撃残留": "280×2",
							"直撃補正":     "195",
							"PA干渉":     "127",
							"冷却性能":     "317",
							"重量":       "2680",
							"EN負荷":     "365",
						},
					},
					"レーザースライサー": {
						"Vvc-774LS": {
							"カテゴリー":    "LASER SLICER",
							"メーカー":     "VCPL",
							"価格":       "339,000",
							"攻撃力":      "1615",
							"衝撃力":      "900",
							"衝撃残留":     "225",
							"連続攻撃回数":   "2",
							"チャージ攻撃力":  "2612",
							"チャージ衝撃力":  "1500",
							"チャージ衝撃残留": "375",
							"直撃補正":     "185",
							"PA干渉":     "122",
							"冷却性能":     "267",
							"重量":       "3260",
							"EN負荷":     "328",
						},
					},
					"レーザーランス": {
						"VE-67LLA": {
							"カテゴリー":    "LASER LANCE",
							"メーカー":     "アーキバス先進開発局",
							"価格":       "270,000",
							"攻撃力":      "1151",
							"衝撃力":      "800",
							"衝撃残留":     "400",
							"連続攻撃回数":   "1",
							"チャージ攻撃力":  "2381",
							"チャージ衝撃力":  "1800",
							"チャージ衝撃残留": "900",
							"直撃補正":     "195",
							"PA干渉":     "131",
							"冷却性能":     "263",
							"重量":       "4520",
							"EN負荷":     "460",
						},
					},
					"プラズマスロアー": {
						"44-143 HMMR": {
							"カテゴリー":    "PLASMA THROWER",
							"メーカー":     "オールマインド",
							"価格":       "172,000",
							"攻撃力":      "1381",
							"衝撃力":      "810",
							"衝撃残留":     "520",
							"連続攻撃回数":   "2",
							"チャージ攻撃力":  "265×6",
							"チャージ衝撃力":  "33×6",
							"チャージ衝撃残留": "22×6",
							"直撃補正":     "165",
							"PA干渉":     "142",
							"有効射程":     "78",
							"冷却性能":     "366",
							"重量":       "2410",
							"EN負荷":     "311",
						},
					},
					"パルスブレード": {
						"HI-32: BU-TT/A": {
							"カテゴリー":    "PULSE BLADE",
							"メーカー":     "タキガワ・ハーモニクス",
							"価格":       "-",
							"攻撃力":      "963",
							"衝撃力":      "710",
							"衝撃残留":     "450",
							"連続攻撃回数":   "2",
							"チャージ攻撃力":  "1586",
							"チャージ衝撃力":  "1200",
							"チャージ衝撃残留": "650",
							"直撃補正":     "230",
							"PA干渉":     "147",
							"冷却性能":     "282",
							"重量":       "1800",
							"EN負荷":     "213",
						},
					},
					"光波ブレード": {
						"IA-C01W2: MOONLIGHT": {
							"カテゴリー":    "LIGHT WAVE BLADE",
							"メーカー":     "ルビコン調査技研",
							"価格":       "270,000",
							"攻撃力":      "615",
							"衝撃力":      "495",
							"衝撃残留":     "495",
							"連続攻撃回数":   "2",
							"チャージ攻撃力":  "2010",
							"チャージ衝撃力":  "910",
							"チャージ衝撃残留": "910",
							"直撃補正":     "175",
							"PA干渉":     "112",
							"有効射程":     "280",
							"冷却性能":     "209",
							"重量":       "2200",
							"EN負荷":     "544",
						},
					},
					"コーラルオシレータ": {
						"IA-C01W7: ML-REDSHIFT": {
							"カテゴリー":    "CORAL OSCILLATOR",
							"メーカー":     "ルビコン調査技研",
							"価格":       "343,000",
							"攻撃力":      "727",
							"衝撃力":      "530",
							"衝撃残留":     "530",
							"連続攻撃回数":   "2",
							"チャージ攻撃力":  "1614",
							"チャージ衝撃力":  "820",
							"チャージ衝撃残留": "820",
							"直撃補正":     "190",
							"PA干渉":     "126",
							"有効射程":     "280",
							"冷却性能":     "209",
							"重量":       "2200",
							"EN負荷":     "544",
						},
						"IB-C03W2: WLT 101": {
							"カテゴリー":    "CORAL OSCILLATOR",
							"メーカー":     "ルビコン調査技研",
							"価格":       "368,000",
							"攻撃力":      "1350",
							"衝撃力":      "960",
							"衝撃残留":     "960",
							"連続攻撃回数":   "1",
							"チャージ攻撃力":  "1950",
							"チャージ衝撃力":  "1450",
							"チャージ衝撃残留": "1450",
							"直撃補正":     "210",
							"PA干渉":     "140",
							"冷却性能":     "199",
							"重量":       "2030",
							"EN負荷":     "642",
						},
					},
				},
			},
			ErrMsg: "",
		},
	}
	c := crawler.NewCrossWeaponCrawler()
	t.Run(test.name, func(t *testing.T) {
		results, err := c.Crawl()
		assert.Equal(t, err, nil)
		assert.Equal(t, test.want.Value, results)
	})
}
