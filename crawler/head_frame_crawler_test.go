package crawler_test

import (
	"testing"

	"github.com/capybara-alt/my-assemble/crawler"
	"github.com/capybara-alt/my-assemble/model"
	"github.com/stretchr/testify/assert"
)

func TestHeadCrawler(t *testing.T) {
	test := struct {
		name string
		want model.Want[model.CrawlResultJSON]
	}{
		name: "[正常系]頭部装備ページのクロールテスト",
		want: model.Want[model.CrawlResultJSON]{
			Value: model.CrawlResultJSON{
				string(model.HEAD_UNIT_TYPE): {
					"頭部パーツ": {
						"AH-J-124 BASHO": {
							"メーカー":     "BAWS",
							"価格":       "61,000",
							"レギュレーション": "1.03.1",
							"AP":       "1250",
							"耐弾防御":     "191",
							"耐EN防御":    "169",
							"耐爆防御":     "192",
							"姿勢安定性能":   "370",
							"システム復元性能": "84 (+16)",
							"スキャン距離":   "340",
							"スキャン持続時間": "14.4",
							"スキャン待機時間": "10.8",
							"重量":       "4600",
							"EN負荷":     "95",
						},
						"AH-J-124/RC JAILBREAK": {
							"メーカー":     "BAWS",
							"価格":       "-",
							"AP":       "1000",
							"耐弾防御":     "181",
							"耐EN防御":    "159",
							"耐爆防御":     "182",
							"姿勢安定性能":   "302",
							"システム復元性能": "60",
							"スキャン距離":   "400",
							"スキャン持続時間": "6.0",
							"スキャン待機時間": "10.8",
							"重量":       "4250",
							"EN負荷":     "95",
						},
						"HD-011 MELANDER": {
							"メーカー":     "ベイラム",
							"価格":       "75,000",
							"レギュレーション": "1.03.1",
							"AP":       "910",
							"耐弾防御":     "173",
							"耐EN防御":    "168",
							"耐爆防御":     "170",
							"姿勢安定性能":   "430 (+30)",
							"システム復元性能": "115 (+5)",
							"スキャン距離":   "310",
							"スキャン持続時間": "4.8",
							"スキャン待機時間": "4.2",
							"重量":       "3160",
							"EN負荷":     "135",
						},
						"HD-033M VERRILL": {
							"メーカー":     "ベイラム",
							"価格":       "205,000",
							"レギュレーション": "1.03.1",
							"AP":       "1080",
							"耐弾防御":     "188",
							"耐EN防御":    "185",
							"耐爆防御":     "185",
							"姿勢安定性能":   "469",
							"システム復元性能": "112 (+5)",
							"スキャン距離":   "510",
							"スキャン持続時間": "7.8",
							"スキャン待機時間": "5.4",
							"重量":       "3830",
							"EN負荷":     "240",
						},
						"HD-012 MELANDER C3": {
							"メーカー":     "ベイラム",
							"価格":       "-",
							"レギュレーション": "1.03.1",
							"AP":       "970",
							"耐弾防御":     "175",
							"耐EN防御":    "177",
							"耐爆防御":     "169",
							"姿勢安定性能":   "436 (+20)",
							"システム復元性能": "106 (+11)",
							"スキャン距離":   "580",
							"スキャン持続時間": "12.0",
							"スキャン待機時間": "10.8",
							"重量":       "3300",
							"EN負荷":     "165",
						},
						"DF-HD-08 TIAN-QIANG": {
							"メーカー":     "大豊",
							"価格":       "58,000",
							"レギュレーション": "1.03.1",
							"AP":       "320",
							"耐弾防御":     "142",
							"耐EN防御":    "140",
							"耐爆防御":     "184",
							"姿勢安定性能":   "207 (+110)",
							"システム復元性能": "73 (+23)",
							"スキャン距離":   "250",
							"スキャン持続時間": "7.0",
							"スキャン待機時間": "11.4",
							"重量":       "1230",
							"EN負荷":     "88",
						},
						"VP-44S": {
							"メーカー":     "アーキバス",
							"価格":       "124,000",
							"レギュレーション": "1.03.1",
							"AP":       "850",
							"耐弾防御":     "170",
							"耐EN防御":    "172",
							"耐爆防御":     "168",
							"姿勢安定性能":   "408 (+30)",
							"システム復元性能": "117 (+5)",
							"スキャン距離":   "520",
							"スキャン持続時間": "7.2",
							"スキャン待機時間": "5.1",
							"重量":       "3080",
							"EN負荷":     "148",
						},
						"VP-44D": {
							"メーカー":     "アーキバス",
							"価格":       "231,000",
							"レギュレーション": "1.03.1",
							"AP":       "880",
							"耐弾防御":     "150",
							"耐EN防御":    "183",
							"耐爆防御":     "172",
							"姿勢安定性能":   "496 (-25)",
							"システム復元性能": "100",
							"スキャン距離":   "530",
							"スキャン持続時間": "14.4",
							"スキャン待機時間": "10.2",
							"重量":       "3260",
							"EN負荷":     "177",
						},
						"NACHTREIHER/44E": {
							"メーカー":     "シュナイダー",
							"価格":       "84,000",
							"AP":       "590",
							"耐弾防御":     "153",
							"耐EN防御":    "155",
							"耐爆防御":     "152",
							"姿勢安定性能":   "422",
							"システム復元性能": "92",
							"スキャン距離":   "280",
							"スキャン持続時間": "13.2",
							"スキャン待機時間": "9.6",
							"重量":       "2320",
							"EN負荷":     "210",
						},
						"KASUAR/44Z": {
							"メーカー":     "シュナイダー",
							"価格":       "210,000",
							"レギュレーション": "1.03.1",
							"AP":       "400",
							"耐弾防御":     "149",
							"耐EN防御":    "157",
							"耐爆防御":     "151",
							"姿勢安定性能":   "498",
							"システム復元性能": "128 (+20)",
							"スキャン距離":   "620",
							"スキャン持続時間": "5.4",
							"スキャン待機時間": "3.6",
							"重量":       "2590",
							"EN負荷":     "254",
						},
						"VE-44A": {
							"メーカー":     "アーキバス",
							"価格":       "275,000",
							"レギュレーション": "1.03.1",
							"AP":       "1060",
							"耐弾防御":     "179",
							"耐EN防御":    "188",
							"耐爆防御":     "178",
							"姿勢安定性能":   "413 (+20)",
							"システム復元性能": "110 (+6)",
							"スキャン距離":   "490",
							"スキャン持続時間": "12.6",
							"スキャン待機時間": "9.9",
							"重量":       "3640",
							"EN負荷":     "182",
						},
						"VE-44B": {
							"メーカー":     "アーキバス",
							"価格":       "306,000",
							"AP":       "1040",
							"耐弾防御":     "167",
							"耐EN防御":    "181",
							"耐爆防御":     "166",
							"姿勢安定性能":   "435",
							"システム復元性能": "154",
							"スキャン距離":   "700",
							"スキャン持続時間": "18.0",
							"スキャン待機時間": "4.8",
							"重量":       "4320",
							"EN負荷":     "265",
						},
						"HC-2000 FINDER EYE": {
							"メーカー":     "RaD",
							"価格":       "-",
							"レギュレーション": "1.03.1",
							"AP":       "660",
							"耐弾防御":     "157",
							"耐EN防御":    "142",
							"耐爆防御":     "153",
							"姿勢安定性能":   "346",
							"システム復元性能": "102 (+4)",
							"スキャン距離":   "290",
							"スキャン持続時間": "4.2",
							"スキャン待機時間": "3.6",
							"重量":       "2670",
							"EN負荷":     "125",
						},
						"HC-2000/BC SHADE EYE": {
							"メーカー":     "RaD",
							"価格":       "147,000",
							"レギュレーション": "1.03.1",
							"AP":       "770",
							"耐弾防御":     "174",
							"耐EN防御":    "167",
							"耐爆防御":     "181",
							"姿勢安定性能":   "448",
							"システム復元性能": "120 (+5)",
							"スキャン距離":   "450",
							"スキャン持続時間": "10.8",
							"スキャン待機時間": "9.0",
							"重量":       "3090",
							"EN負荷":     "163",
						},
						"HC-3000 WRECKER": {
							"メーカー":     "RaD",
							"価格":       "59,000",
							"レギュレーション": "1.03.1",
							"AP":       "1130",
							"耐弾防御":     "200",
							"耐EN防御":    "170",
							"耐爆防御":     "187",
							"姿勢安定性能":   "322",
							"システム復元性能": "75 (+20)",
							"スキャン距離":   "270",
							"スキャン持続時間": "3.0",
							"スキャン待機時間": "12.0",
							"重量":       "3800",
							"EN負荷":     "102",
						},
						"HS-5000 APPETIZER": {
							"メーカー":     "RaD",
							"価格":       "199,000",
							"レギュレーション": "1.03.1",
							"AP":       "760",
							"耐弾防御":     "176",
							"耐EN防御":    "180",
							"耐爆防御":     "176",
							"姿勢安定性能":   "376 (+50)",
							"システム復元性能": "93 (+15)",
							"スキャン距離":   "610",
							"スキャン持続時間": "6.0",
							"スキャン待機時間": "4.8",
							"重量":       "3000",
							"EN負荷":     "103",
						},
						"EL-TH-10 FIRMEZA": {
							"メーカー":     "エルカノ",
							"価格":       "177,000",
							"レギュレーション": "1.03.1",
							"AP":       "480",
							"耐弾防御":     "156",
							"耐EN防御":    "158",
							"耐爆防御":     "154",
							"姿勢安定性能":   "398",
							"システム復元性能": "99 (+11)",
							"スキャン距離":   "330",
							"スキャン持続時間": "15.0",
							"スキャン待機時間": "9.6",
							"重量":       "2570",
							"EN負荷":     "134",
						},
						"EL-PH-00 ALBA": {
							"メーカー":     "エルカノ",
							"価格":       "208,000",
							"レギュレーション": "1.03.1",
							"AP":       "600",
							"耐弾防御":     "171",
							"耐EN防御":    "171",
							"耐爆防御":     "171",
							"姿勢安定性能":   "414",
							"システム復元性能": "111 (+6)",
							"スキャン距離":   "500",
							"スキャン持続時間": "3.6",
							"スキャン待機時間": "5.4",
							"重量":       "2800",
							"EN負荷":     "205",
						},
						"20-081 MIND ALPHA": {
							"メーカー":     "オールマインド",
							"価格":       "223,000",
							"レギュレーション": "1.03.1",
							"AP":       "820",
							"耐弾防御":     "178",
							"耐EN防御":    "186",
							"耐爆防御":     "173",
							"姿勢安定性能":   "395 (+30)",
							"システム復元性能": "109 (+6)",
							"スキャン距離":   "320",
							"スキャン持続時間": "6.0",
							"スキャン待機時間": "4.8",
							"重量":       "3350",
							"EN負荷":     "142",
						},
						"20-082 MIND BETA": {
							"メーカー":     "オールマインド",
							"価格":       "261,000",
							"レギュレーション": "1.03.1",
							"AP":       "520",
							"耐弾防御":     "158",
							"耐EN防御":    "164",
							"耐爆防御":     "150",
							"姿勢安定性能":   "536",
							"システム復元性能": "96 (-20)",
							"スキャン距離":   "540",
							"スキャン持続時間": "12.0",
							"スキャン待機時間": "9.0",
							"重量":       "3460",
							"EN負荷":     "128",
						},
						"IA-C01H: EPHEMERA": {
							"メーカー":     "ルビコン調査技研",
							"価格":       "237,000",
							"AP":       "990",
							"耐弾防御":     "160",
							"耐EN防御":    "189",
							"耐爆防御":     "186",
							"姿勢安定性能":   "480",
							"システム復元性能": "132",
							"スキャン距離":   "550",
							"スキャン持続時間": "4.8",
							"スキャン待機時間": "6.0",
							"重量":       "4330",
							"EN負荷":     "233",
						},
						"IB-C03H: HAL 826": {
							"メーカー":     "ルビコン調査技研",
							"価格":       "254,000",
							"レギュレーション": "1.03.1",
							"AP":       "930",
							"耐弾防御":     "169",
							"耐EN防御":    "182",
							"耐爆防御":     "180",
							"姿勢安定性能":   "451 (+15)",
							"システム復元性能": "125",
							"スキャン距離":   "600",
							"スキャン持続時間": "16.8",
							"スキャン待機時間": "11.4",
							"重量":       "3760",
							"EN負荷":     "215",
						},
					},
				},
			},
			ErrMsg: "",
		},
	}
	c := crawler.NewHeadFrameCrawler()
	t.Run(test.name, func(t *testing.T) {
		results, err := c.Crawl()
		assert.Equal(t, err, nil)
		assert.Equal(t, test.want.Value, results)
	})
}
