package crawler_test

import (
	"testing"

	"github.com/capybara-alt/my-assemble/crawler"
	"github.com/capybara-alt/my-assemble/model"
	"github.com/stretchr/testify/assert"
)

func TestLauncherCannonWeaponCrawler(t *testing.T) {
	test := struct {
		name string
		want model.Want[model.CrawlResultJSON]
	}{
		name: "[正常系]ランチャー・キャノンページのクロールテスト",
		want: model.Want[model.CrawlResultJSON]{
			Value: model.CrawlResultJSON{
				string(model.DEFAULT_WEAPON_BACK_UNIT_TYPE): {
					"スプレッドバズーカ": {
						"SB-033M MORLEY": {
							"カテゴリー":  "SPREAD BAZOOKA",
							"メーカー":   "ベイラム",
							"価格":     "255,000",
							"攻撃力":    "1360",
							"衝撃力":    "1450",
							"衝撃残留":   "860",
							"爆発範囲":   "15",
							"直撃補正":   "190",
							"射撃反動":   "70",
							"有効射程":   "510",
							"総弾数":    "20",
							"リロード時間": "5.0",
							"弾単価":    "800",
							"重量":     "8480",
							"EN負荷":   "465",
						},
					},
					"グレネードキャノン": {
						"EARSHOT": {
							"カテゴリー":    "GRENADE CANNON",
							"メーカー":     "メリニット",
							"価格":       "303,000",
							"レギュレーション": "1.03.1",
							"攻撃力":      "2098",
							"衝撃力":      "1455",
							"衝撃残留":     "1101",
							"爆発範囲":     "90",
							"直撃補正":     "145",
							"射撃反動":     "70",
							"有効射程":     "720",
							"総弾数":      "16",
							"リロード時間":   "9.3 (-3.5)",
							"弾単価":      "1600",
							"重量":       "7230",
							"EN負荷":     "386",
						},
						"SONGBIRDS": {
							"カテゴリー":    "GRENADE CANNON",
							"メーカー":     "メリニット",
							"価格":       "182,000",
							"レギュレーション": "1.03.1",
							"攻撃力":      "655×2 (-99)",
							"衝撃力":      "635×2 (-110)",
							"衝撃残留":     "494×2 (-91)",
							"爆発範囲":     "60",
							"直撃補正":     "140",
							"射撃反動":     "60",
							"有効射程":     "625",
							"総弾数":      "42",
							"リロード時間":   "6.4",
							"弾単価":      "600",
							"重量":       "5500",
							"EN負荷":     "285",
						},
					},
					"スタンニードルランチャー": {
						"VE-60SNA": {
							"カテゴリー":    "STUN NEEDLE LAUNCHER",
							"メーカー":     "アーキバス先進開発局",
							"価格":       "283,000",
							"レギュレーション": "1.03.1",
							"攻撃力":      "1088",
							"衝撃力":      "641 (-266)",
							"衝撃残留":     "339 (-98)",
							"爆発範囲":     "30",
							"直撃補正":     "195 (-30)",
							"射撃反動":     "70",
							"性能保証射程":   "280",
							"有効射程":     "490",
							"総弾数":      "30",
							"リロード時間":   "5.0",
							"弾単価":      "800",
							"重量":       "6150",
							"EN負荷":     "825",
						},
					},
					"レーザーキャノン": {
						"VP-60LCS": {
							"カテゴリー":     "LASER CANNON",
							"メーカー":      "アーキバス",
							"価格":        "147,000",
							"レギュレーション":  "1.03.1",
							"攻撃力":       "925",
							"衝撃力":       "500",
							"衝撃残留":      "180",
							"攻撃時発熱":     "320",
							"チャージ攻撃力":   "1621",
							"チャージ衝撃力":   "750",
							"チャージ衝撃残留":  "280",
							"チャージ攻撃時発熱": "1000",
							"直撃補正":      "145",
							"射撃反動":      "70",
							"性能保証射程":    "230",
							"有効射程":      "359",
							"連射性能":      "0.7",
							"チャージEN負荷":  "759",
							"チャージ時間":    "1.6",
							"チャージ消費弾数":  "3",
							"総弾数":       "57 (+25)",
							"冷却性能":      "210",
							"弾単価":       "450",
							"重量":        "5190",
							"EN負荷":      "683",
						},
						"VE-60LCA": {
							"カテゴリー":     "LASER CANNON",
							"メーカー":      "アーキバス先進開発局",
							"価格":        "333,000",
							"攻撃力":       "633×3",
							"衝撃力":       "199×3",
							"衝撃残留":      "76×3",
							"攻撃時発熱":     "700",
							"チャージ攻撃力":   "1015×3",
							"チャージ衝撃力":   "330×3",
							"チャージ衝撃残留":  "185×3",
							"チャージ攻撃時発熱": "1000",
							"直撃補正":      "145",
							"射撃反動":      "70",
							"性能保証射程":    "240",
							"有効射程":      "402",
							"連射性能":      "0.4",
							"チャージEN負荷":  "1440",
							"チャージ時間":    "5.0",
							"チャージ消費弾数":  "6",
							"総弾数":       "24",
							"冷却性能":      "155",
							"弾単価":       "450",
							"重量":        "14820",
							"EN負荷":      "1200",
						},
					},
					"拡散レーザーキャノン": {
						"VP-60LCD": {
							"カテゴリー":     "DIFFUSE LASER CANNON",
							"メーカー":      "アーキバス",
							"価格":        "215,000",
							"レギュレーション":  "1.03.1",
							"攻撃力":       "1308",
							"衝撃力":       "648",
							"衝撃残留":      "204",
							"攻撃時発熱":     "440",
							"チャージ攻撃力":   "1782",
							"チャージ衝撃力":   "980",
							"チャージ衝撃残留":  "439",
							"チャージ爆発範囲":  "45",
							"チャージ攻撃時発熱": "1000",
							"直撃補正":      "145",
							"射撃反動":      "45",
							"性能保証射程":    "180",
							"有効射程":      "252",
							"連射性能":      "0.6",
							"チャージEN負荷":  "902",
							"チャージ時間":    "2.0",
							"チャージ消費弾数":  "3",
							"総弾数":       "54 (+26)",
							"冷却性能":      "232",
							"弾単価":       "650",
							"重量":        "7620",
							"EN負荷":      "784",
						},
					},
					"プラズマキャノン": {
						"FASAN/60E": {
							"カテゴリー":     "PLASMA CANNON",
							"メーカー":      "シュナイダー",
							"価格":        "217,000",
							"攻撃力":       "1560",
							"衝撃力":       "840",
							"衝撃残留":      "570",
							"爆発範囲":      "30",
							"攻撃時発熱":     "465",
							"チャージ攻撃力":   "2412",
							"チャージ衝撃力":   "1272",
							"チャージ衝撃残留":  "792",
							"チャージ爆発範囲":  "60",
							"チャージ攻撃時発熱": "1000",
							"直撃補正":      "125",
							"射撃反動":      "70",
							"有効射程":      "440",
							"連射性能":      "0.5",
							"チャージEN負荷":  "944",
							"チャージ時間":    "2.0",
							"チャージ消費弾数":  "3",
							"総弾数":       "39",
							"冷却性能":      "196",
							"弾単価":       "540",
							"重量":        "6270",
							"EN負荷":      "882",
						},
					},
					"パルスキャノン": {
						"KRANICH/60Z": {
							"カテゴリー": "PULSE CANNON",
							"メーカー":  "シュナイダー",
							"価格":    "177,000",
							"攻撃力":   "85",
							"衝撃力":   "20",
							"衝撃残留":  "10",
							"攻撃時発熱": "65",
							"直撃補正":  "145",
							"PA干渉":  "550",
							"射撃反動":  "10",
							"有効射程":  "490",
							"連射性能":  "10.0",
							"総弾数":   "560",
							"冷却性能":  "225",
							"弾単価":   "40",
							"重量":    "2100",
							"EN負荷":  "652",
						},
					},
					"パルスシールドランチャー": {
						"EULE/60D": {
							"カテゴリー":    "PULSE SHIELD LAUNCHER",
							"メーカー":     "シュナイダー",
							"価格":       "243,000",
							"レギュレーション": "1.03.1",
							"攻撃力":      "455",
							"衝撃力":      "640",
							"衝撃残留":     "461",
							"爆発範囲":     "15",
							"直撃補正":     "155",
							"PA干渉":     "175",
							"射撃反動":     "4",
							"有効射程":     "62",
							"連射性能":     "3.4",
							"マガジン弾数":   "3",
							"総弾数":      "62 (+38)",
							"リロード時間":   "6.0",
							"弾単価":      "400",
							"重量":       "2760 (-300)",
							"EN負荷":     "382 (-238)",
						},
					},
					"光波キャノン": {
						"IA-C01W3：AURORA": {
							"カテゴリー":    "LIGHT WAVE CANNON",
							"メーカー":     "ルビコン調査技研",
							"価格":       "",
							"レギュレーション": "1.03.1",
							"攻撃力":      "134×4",
							"衝撃力":      "102×4",
							"衝撃残留":     "102×4",
							"直撃補正":     "175",
							"PA干渉":     "117",
							"誘導性能":     "240",
							"有効射程":     "930",
							"誘導ロック時間":  "3.3",
							"最大ロック数":   "4",
							"総弾数":      "100",
							"リロード時間":   "5.5",
							"弾単価":      "80",
							"重量":       "3330",
							"EN負荷":     "390 (-132)",
						},
					},
				},
			},
			ErrMsg: "",
		},
	}
	c := crawler.NewLauncherWeaponCrawler()
	t.Run(test.name, func(t *testing.T) {
		results, err := c.Crawl()
		assert.Equal(t, err, nil)
		assert.Equal(t, test.want.Value, results)
	})
}
