package crawler_test

import (
	"testing"

	"github.com/capybara-alt/my-assemble/crawler"
	"github.com/capybara-alt/my-assemble/model"
	"github.com/stretchr/testify/assert"
)

func TestCoreUnitCrawler(t *testing.T) {
	test := struct {
		name string
		want model.Want[model.CrawlResultJSON]
	}{
		name: "[正常系]Core Frameページのクロールテスト",
		want: model.Want[model.CrawlResultJSON]{
			Value: model.CrawlResultJSON{
				string(model.CORE_UNIT_TYPE): {
					"コアパーツ": {
						"AC-J-120 BASHO": {
							"メーカー":       "BAWS",
							"価格":         "186,000",
							"AP":         "3580",
							"耐弾防御":       "435",
							"耐EN防御":      "398",
							"耐爆防御":       "460",
							"姿勢安定性能":     "476",
							"ブースタ効率補正":   "119",
							"ジェネレータ出力補正": "83",
							"ジェネレータ供給補正": "94",
							"重量":         "16100",
							"EN負荷":       "300",
						},
						"AC-J-120/RC JAILBREAK": {
							"メーカー":       "BAWS",
							"価格":         "-",
							"AP":         "2400",
							"耐弾防御":       "405",
							"耐EN防御":      "368",
							"耐爆防御":       "420",
							"姿勢安定性能":     "403",
							"ブースタ効率補正":   "119",
							"ジェネレータ出力補正": "83",
							"ジェネレータ供給補正": "94",
							"重量":         "12350",
							"EN負荷":       "300",
						},
						"BD-011 MELANDER": {
							"メーカー":       "ベイラム",
							"価格":         "195,000",
							"AP":         "3230",
							"耐弾防御":       "438",
							"耐EN防御":      "380",
							"耐爆防御":       "429",
							"姿勢安定性能":     "458",
							"ブースタ効率補正":   "98",
							"ジェネレータ出力補正": "105",
							"ジェネレータ供給補正": "97",
							"重量":         "15800",
							"EN負荷":       "304",
						},
						"BD-012 MELANDER C3": {
							"メーカー":       "ベイラム",
							"価格":         "-",
							"AP":         "2830",
							"耐弾防御":       "425",
							"耐EN防御":      "377",
							"耐爆防御":       "428",
							"姿勢安定性能":     "433",
							"ブースタ効率補正":   "103",
							"ジェネレータ出力補正": "102",
							"ジェネレータ供給補正": "103",
							"重量":         "14050",
							"EN負荷":       "322",
						},
						"DF-BD-08 TIAN-QIANG": {
							"メーカー":       "大豊",
							"価格":         "390,000",
							"AP":         "4100",
							"耐弾防御":       "473",
							"耐EN防御":      "438",
							"耐爆防御":       "478",
							"姿勢安定性能":     "629",
							"ブースタ効率補正":   "76",
							"ジェネレータ出力補正": "114",
							"ジェネレータ供給補正": "90",
							"重量":         "20650",
							"EN負荷":       "388",
						},
						"VP-40S": {
							"メーカー":       "アーキバス",
							"価格":         "354,000",
							"AP":         "3160",
							"耐弾防御":       "427",
							"耐EN防御":      "436",
							"耐爆防御":       "389",
							"姿勢安定性能":     "446",
							"ブースタ効率補正":   "102",
							"ジェネレータ出力補正": "106",
							"ジェネレータ供給補正": "102",
							"重量":         "15030",
							"EN負荷":       "337",
						},
						"NACHTREIHER/40E": {
							"メーカー":       "シュナイダー",
							"価格":         "275,000",
							"レギュレーション":   "1.03.1",
							"AP":         "2630",
							"耐弾防御":       "349",
							"耐EN防御":      "359",
							"耐爆防御":       "331",
							"姿勢安定性能":     "366 (+17)",
							"ブースタ効率補正":   "126",
							"ジェネレータ出力補正": "91 (+7)",
							"ジェネレータ供給補正": "109",
							"重量":         "9820",
							"EN負荷":       "330",
						},
						"VE-40A": {
							"メーカー":       "アーキバス",
							"価格":         "570,000",
							"AP":         "4320",
							"耐弾防御":       "447",
							"耐EN防御":      "495",
							"耐爆防御":       "458",
							"姿勢安定性能":     "521",
							"ブースタ効率補正":   "81",
							"ジェネレータ出力補正": "122",
							"ジェネレータ供給補正": "95",
							"重量":         "21100",
							"EN負荷":       "432",
						},
						"CC-2000 ORBITER": {
							"メーカー":       "RaD",
							"価格":         "-",
							"AP":         "2780",
							"耐弾防御":       "393",
							"耐EN防御":      "366",
							"耐爆防御":       "374",
							"姿勢安定性能":     "407",
							"ブースタ効率補正":   "100",
							"ジェネレータ出力補正": "103",
							"ジェネレータ供給補正": "93",
							"重量":         "12650",
							"EN負荷":       "267",
						},
						"CC-3000 WRECKER": {
							"メーカー":       "RaD",
							"価格":         "158,000",
							"AP":         "3940",
							"耐弾防御":       "468",
							"耐EN防御":      "434",
							"耐爆防御":       "461",
							"姿勢安定性能":     "532",
							"ブースタ効率補正":   "80",
							"ジェネレータ出力補正": "96",
							"ジェネレータ供給補正": "100",
							"重量":         "19000",
							"EN負荷":       "310",
						},
						"CS-5000 MAIN DISH": {
							"メーカー":       "RaD",
							"価格":         "519,000",
							"AP":         "3890",
							"耐弾防御":       "476",
							"耐EN防御":      "489",
							"耐爆防御":       "469",
							"姿勢安定性能":     "641",
							"ブースタ効率補正":   "79",
							"ジェネレータ出力補正": "97",
							"ジェネレータ供給補正": "112",
							"重量":         "23600",
							"EN負荷":       "413",
						},
						"EL-TC-10 FIRMEZA": {
							"メーカー":       "エルカノ",
							"価格":         "452,000",
							"AP":         "2500",
							"耐弾防御":       "384",
							"耐EN防御":      "360",
							"耐爆防御":       "375",
							"姿勢安定性能":     "410",
							"ブースタ効率補正":   "111",
							"ジェネレータ出力補正": "104",
							"ジェネレータ供給補正": "89",
							"重量":         "10890",
							"EN負荷":       "351",
						},
						"EL-PC-00 ALBA": {
							"メーカー":       "エルカノ",
							"価格":         "531,000",
							"AP":         "2850",
							"耐弾防御":       "370",
							"耐EN防御":      "370",
							"耐爆防御":       "370",
							"姿勢安定性能":     "368",
							"ブースタ効率補正":   "115",
							"ジェネレータ出力補正": "101",
							"ジェネレータ供給補正": "105",
							"重量":         "12000",
							"EN負荷":       "315",
						},
						"07-061 MIND ALPHA": {
							"メーカー":       "オールマインド",
							"価格":         "553,000",
							"AP":         "3520",
							"耐弾防御":       "440",
							"耐EN防御":      "455",
							"耐爆防御":       "445",
							"姿勢安定性能":     "455",
							"ブースタ効率補正":   "95",
							"ジェネレータ出力補正": "112",
							"ジェネレータ供給補正": "104",
							"重量":         "16510",
							"EN負荷":       "364",
						},
						"IA-C01C: EPHEMERA": {
							"メーカー":       "ルビコン調査技研",
							"価格":         "590,000",
							"レギュレーション":   "1.03.1",
							"AP":         "2710 (-400)",
							"耐弾防御":       "335",
							"耐EN防御":      "382 (-70)",
							"耐爆防御":       "350 (-80)",
							"姿勢安定性能":     "353 (-10)",
							"ブースタ効率補正":   "101",
							"ジェネレータ出力補正": "126",
							"ジェネレータ供給補正": "96",
							"重量":         "13200",
							"EN負荷":       "412",
						},
						"IB-C03C: HAL 826": {
							"メーカー":       "ルビコン調査技研",
							"価格":         "663,000",
							"AP":         "3670",
							"耐弾防御":       "451",
							"耐EN防御":      "469",
							"耐爆防御":       "463",
							"姿勢安定性能":     "385",
							"ブースタ効率補正":   "96",
							"ジェネレータ出力補正": "120",
							"ジェネレータ供給補正": "108",
							"重量":         "18520",
							"EN負荷":       "366",
						},
					},
				},
			},
			ErrMsg: "",
		},
	}
	c := crawler.NewCoreFrameCrawler()
	t.Run(test.name, func(t *testing.T) {
		results, err := c.Crawl()
		assert.Equal(t, err, nil)
		assert.Equal(t, test.want.Value, results)
	})
}
